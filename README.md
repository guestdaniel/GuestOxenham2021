This repository contains all the code and behavioral data necessary to completely replicate the figures found in Guest and Oxenham (2021). The codebase is a mixture of Python and R, with Python mostly being used to conduct neural simulations and R mostly being used to analyze behavioral data and create figures. The code relies on a number of external libraries, including more common ones such as `numpy` and `scipy`, as well as auditory-specific libraries such as `cochlea`, `gammatone`, and our modeling toolbox, `apcmodels`.

# File structure

The basic file structure is shown in the file hierarchy below. Essential code required to generate the subfigures in each paper figure is stored in its own folder. A variety of code that was integral to the neural simulations featured in the paper but does not correspond to one particular figure is located in the `nofigure` subfolder. Finally, a few other scripts and utilities are stored in top-level `.R` and `.py` files. 

```
.  
├── figure1                  # Code for Figure 1
├── ...  
├── figure4                  # Code for Figure 5
│   ├── figure4a.py          # Python code to generate run simulations featured in Figure 4
│   ├── figure4a.R           # R code to plot results from figure4.py
│   ├── *.csv                # Results generated by figure4.py
│   └── ...      
├── figure5                  # Code for Figure 5, similar in structure to /figure4
├── figure6                  # Code for Figure 6
├── nofigure                 # Code that is needed but is not directly featured in a manuscript figure
│   ├── absolute_thresholds  # Scripts to estimate absolute thresholds at a range of CFs
│   ├── tuning_curves        # Scripts to estimate tuning curves and Q10 values at a range of CFs
│   └── vector_strength      # Scripts to estimate vector strength at a range of CFs
├── plots                    # .png files, exact matches for figures in manuscript
├── supplemental_figure_1    # Scripts to generate the supplemental figure
├── config.py                # Short script to provide constants shared across all Python files
├── config.R                 # Short script to provide constants shared across all R files
├── functions.py             # Miscellaneous functions used by a few Python scripts
├── LICENSE                  # License file for this repository
└── README.md                # This README file
```

# Instructions

To replicate the paper figures, you will need a working installs of Python and R. Instructions for how to install each and configure your environments are provided below. Once you have successfully installed both R and Python and the requisite packages for each, proceed to `Run figure code` below and follow the instructions there to generate each figure. All of the resultant `.png` files will be stored in `plots`. 

## Python

A Python 3 interpreter is required to run the simulation code (Figure 4, Figure 5, Figure 6, supplemental figures). We recommend using `pyenv`, `conda`, or another similar tool to install Python 3.6, as well as the packages (with version numbers) listed below:

### Packages
- `numpy` -
- `scipy` -
- `pathos` -
- ``

## R

R is required to generate all the behavioral and modeling figures. The paper figures were generated using R 4.0.3, although in theory any fairly recent version of R should suffice. Below a list of required packages (and the versions used to generate the figures) is provided:

### Packages
- `merTools` - 0.5.2
- `dplyr` - 1.0.2
- `effects` - 4.2-0
- `ggplot2` - 3.3.2
- `lme4` - 1.1-25
- `phia` - 0.2-1
- `tidyr` - 1.1.2

Start R and set your working directory to wherever this repository is located. Now, you can run any of the plotting scripts (e.g., `figure1.R`) Some of these scripts depend on the output of the Python scripts. However, every required output has been pre-generated and included in this repository. These outputs are precisely those used to generate the figures in the manuscript. As a result, all the R scripts should correctly generate the paper figures even if you don't have a Python interpreter installed, or you have not yet run the Python scripts. 

## Run figure code